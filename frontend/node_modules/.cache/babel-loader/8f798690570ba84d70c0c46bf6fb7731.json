{"ast":null,"code":"import _toConsumableArray from\"/Users/Marcus/CPHBUSINESS/3.semester/CA3_Personal_frontend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/Marcus/CPHBUSINESS/3.semester/CA3_Personal_frontend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/Marcus/CPHBUSINESS/3.semester/CA3_Personal_frontend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/Marcus/CPHBUSINESS/3.semester/CA3_Personal_frontend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import facade from\"../facades/LoginFacade\";import React,{useState,useEffect}from\"react\";import\"./Login.css\";import{Link}from\"react-router-dom\";function Login(_ref){var login=_ref.login,user=_ref.user;var init={username:\"\",password:\"\"};var _useState=useState(init),_useState2=_slicedToArray(_useState,2),loginCredentials=_useState2[0],setLoginCredentials=_useState2[1];var performLogin=function performLogin(evt){evt.preventDefault();login(loginCredentials.username,loginCredentials.password);};var onChange=function onChange(evt){setLoginCredentials(_objectSpread(_objectSpread({},loginCredentials),{},_defineProperty({},evt.target.id,evt.target.value)));};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onChange:onChange,className:\"form__group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input\",children:/*#__PURE__*/_jsx(\"input\",{type:\"input\",className:\"form__field\",placeholder:\"Name\",name:\"username\",id:\"username\",required:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"input\",children:/*#__PURE__*/_jsx(\"input\",{type:\"input\",className:\"form__field\",placeholder:\"Password\",name:\"password\",id:\"password\",required:true})}),/*#__PURE__*/_jsx(\"button\",{onClick:performLogin,children:\"Login\"})]}),user!==\"Loading...\"?user:/*#__PURE__*/_jsx(_Fragment,{children:\" \"}),/*#__PURE__*/_jsx(Link,{to:\"/signup\",children:\"Sign-up\"})]});}function LoggedIn(_ref2){var user=_ref2.user,setUser=_ref2.setUser,setUserRole=_ref2.setUserRole,setLoggedIn=_ref2.setLoggedIn,userRole=_ref2.userRole;useEffect(function(){setLoggedIn(true);try{facade.fetchUserRole(\"user\").then(function(data){setUserRole(_toConsumableArray(data.roles));setUser(data.name);}).catch(function(err){});facade.fetchUserRole(\"admin\").then(function(data){setUserRole(_toConsumableArray(data.roles));setUser(data.name);}).catch(function(err){});}catch(err){setLoggedIn(false);console.log(err);}},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Data Received from server\"}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Hello \",user]}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Your role is \",userRole.map(function(e){return/*#__PURE__*/_jsxs(_Fragment,{children:[\" \",e,\" \"]});})]})]});}function LoginDisplay(_ref3){var login=_ref3.login,setUser=_ref3.setUser,user=_ref3.user,loggedIn=_ref3.loggedIn,logout=_ref3.logout,setUserRole=_ref3.setUserRole,userRole=_ref3.userRole,setLoggedIn=_ref3.setLoggedIn;return/*#__PURE__*/_jsx(\"div\",{className:\"login\",children:!loggedIn?/*#__PURE__*/_jsx(Login,{login:login,user:user}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(LoggedIn,{userRole:userRole,setUser:setUser,user:user,setUserRole:setUserRole,setLoggedIn:setLoggedIn}),/*#__PURE__*/_jsx(\"button\",{onClick:logout,children:\"Logout\"})]})});}export default LoginDisplay;","map":{"version":3,"sources":["/Users/Marcus/CPHBUSINESS/3.semester/CA3_Personal_frontend/frontend/src/components/Login.js"],"names":["facade","React","useState","useEffect","Link","Login","login","user","init","username","password","loginCredentials","setLoginCredentials","performLogin","evt","preventDefault","onChange","target","id","value","LoggedIn","setUser","setUserRole","setLoggedIn","userRole","fetchUserRole","then","data","roles","name","catch","err","console","log","map","e","LoginDisplay","loggedIn","logout"],"mappings":"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","sourcesContent":["import facade from \"../facades/LoginFacade\";\nimport React, { useState, useEffect } from \"react\";\nimport \"./Login.css\";\nimport { Link } from \"react-router-dom\";\n\nfunction Login({ login, user }) {\n  const init = { username: \"\", password: \"\" };\n  const [loginCredentials, setLoginCredentials] = useState(init);\n\n  const performLogin = (evt) => {\n    evt.preventDefault();\n    login(loginCredentials.username, loginCredentials.password);\n  };\n  const onChange = (evt) => {\n    setLoginCredentials({\n      ...loginCredentials,\n      [evt.target.id]: evt.target.value,\n    });\n  };\n\n  return (\n    <div>\n      <h2>Login</h2>\n      <form onChange={onChange} className=\"form__group\">\n        <div className=\"input\">\n          <input\n            type=\"input\"\n            className=\"form__field\"\n            placeholder=\"Name\"\n            name=\"username\"\n            id=\"username\"\n            required\n          />\n        </div>\n        <div className=\"input\">\n          <input\n            type=\"input\"\n            className=\"form__field\"\n            placeholder=\"Password\"\n            name=\"password\"\n            id=\"password\"\n            required\n          />\n        </div>\n        <button onClick={performLogin}>Login</button>\n      </form>\n      {user !== \"Loading...\" ? user : <> </>}\n      <Link to=\"/signup\">Sign-up</Link>\n    </div>\n  );\n}\n\nfunction LoggedIn({ user, setUser, setUserRole, setLoggedIn, userRole }) {\n  useEffect(() => {\n    setLoggedIn(true);\n    try {\n      facade\n        .fetchUserRole(\"user\")\n        .then((data) => {\n          setUserRole([...data.roles]);\n          setUser(data.name);\n        })\n        .catch((err) => {});\n      facade\n        .fetchUserRole(\"admin\")\n        .then((data) => {\n          setUserRole([...data.roles]);\n          setUser(data.name);\n        })\n        .catch((err) => {});\n    } catch (err) {\n      setLoggedIn(false);\n      console.log(err);\n    }\n  }, []);\n\n  return (\n    <div>\n      <h2>Data Received from server</h2>\n      <h3>Hello {user}</h3>\n      <h3>Your role is {userRole.map(e => <> {e} </>)}</h3>\n    </div>\n  );\n}\n\nfunction LoginDisplay({\n  login,\n  setUser,\n  user,\n  loggedIn,\n  logout,\n  setUserRole,\n  userRole,\n  setLoggedIn,\n}) {\n  return (\n    <div className=\"login\">\n      {!loggedIn ? (\n        <Login login={login} user={user} />\n      ) : (\n        <div>\n          <LoggedIn\n            userRole={userRole}\n            setUser={setUser}\n            user={user}\n            setUserRole={setUserRole}\n            setLoggedIn={setLoggedIn}\n          />\n          <button onClick={logout}>Logout</button>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default LoginDisplay;\n"]},"metadata":{},"sourceType":"module"}